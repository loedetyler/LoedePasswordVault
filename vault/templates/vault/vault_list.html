<!--Where all the passwords will be stored and presented-->
{% extends 'layout.html' %}

{% block title %}
    The Vault
{% endblock %}
{% block auth_title %}
    {{ user.username }}'s Vault
{% endblock %}

{% block content %}
{% if user.is_authenticated %}
    <div class="passTable">
        <table>
            <tr>
                <th>Site</th>
                <th>Username</th>
                <th>Password</th>
            </tr>
            {% for entry in passwords %} 
                <tr>
                    <td>{{ entry.site }}</td>
                    <td>{{ entry.username }}</td>
                    <td>{{ entry.password }}</td>
                </tr>
            {% endfor %}
        </table>
    </div>
    <button id="toggleNewPass">New Account</button>
    <form style="display: none;" method="post" action="{% url 'add_password' %}" id="newPass">
        {% csrf_token %}
        <label for="site">Account:</label>
        <input type="text" name="site" required>
        <br>
        <label for="username">Username:</label>
        <input type="text" name="username" required>
        <br>
        <label for="password">Password:</label>
        <input type="text" name="password" required>
        <button type="submit">Submit</button>
        <input type="hidden" name="owner" value={{user.username}}>
    </form>
    <!--Script mostly generated by chatGPT-->
    <script> 
        document.getElementById("toggleNewPass").addEventListener("click", function(){
            const form = document.getElementById("newPass");
            form.style.display = form.style.display === "none" ? "block": "none";
        });
    </script>
    {% else %}
        <p>Please <a href="/users/login">sign in</a> or <a href="/users/register/">create an account</a></p>
    {% endif %}
{% endblock %}